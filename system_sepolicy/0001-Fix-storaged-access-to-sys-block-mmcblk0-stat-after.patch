From 2f7b8f97a63816173c45dff4eb9c0e85868d3116 Mon Sep 17 00:00:00 2001
From: Vladimir Oltean <olteanv@gmail.com>
Date: Tue, 25 Sep 2018 23:09:09 +0300
Subject: [PATCH] Fix storaged access to /sys/block/mmcblk0/stat after 48027a00

* Commit "storaged: remove access to sysfs_type" denied the storaged
  daemon access to the sysfs node it needed to do its work.
* It also didn't provide any means necessary for adding the necessary
  rules at a device level, since its sepolicy is private.
* Here we define a new sysfs_disk_stat security label, which device
  maintainers are supposed to add to their genfs_contexts file. This is
  similar to how hal_health_default and sysfs_batteryinfo is handled.
* What prevents the genfs_contexts from being added here directly is
  that in a typical vendor implementation, these sysfs files are
  actually symlinks and not a single, unified path SELinux-wise.

Change-Id: I13ca09cf2458b22ffb6c70b8a353e891e810c606
Signed-off-by: Vladimir Oltean <olteanv@gmail.com>
(cherry picked from commit 2814cfc532d48f6224d6115ecb1e9fbd7b5ce96e)
---
 prebuilts/api/29.0/private/compat/28.0/28.0.ignore.cil | 1 +
 prebuilts/api/29.0/private/storaged.te                 | 5 +++++
 prebuilts/api/29.0/public/file.te                      | 1 +
 prebuilts/api/30.0/private/compat/28.0/28.0.ignore.cil | 1 +
 prebuilts/api/30.0/private/compat/29.0/29.0.ignore.cil | 1 +
 prebuilts/api/30.0/private/storaged.te                 | 5 +++++
 prebuilts/api/30.0/public/file.te                      | 1 +
 prebuilts/api/31.0/private/compat/28.0/28.0.ignore.cil | 1 +
 prebuilts/api/31.0/private/compat/29.0/29.0.ignore.cil | 1 +
 prebuilts/api/31.0/private/compat/30.0/30.0.ignore.cil | 1 +
 prebuilts/api/31.0/private/storaged.te                 | 5 +++++
 prebuilts/api/31.0/public/file.te                      | 1 +
 prebuilts/api/32.0/private/compat/28.0/28.0.ignore.cil | 1 +
 prebuilts/api/32.0/private/compat/29.0/29.0.ignore.cil | 1 +
 prebuilts/api/32.0/private/compat/30.0/30.0.ignore.cil | 1 +
 prebuilts/api/32.0/private/compat/31.0/31.0.ignore.cil | 1 +
 prebuilts/api/32.0/private/storaged.te                 | 5 +++++
 prebuilts/api/32.0/public/file.te                      | 1 +
 prebuilts/api/33.0/private/compat/28.0/28.0.ignore.cil | 1 +
 prebuilts/api/33.0/private/compat/29.0/29.0.ignore.cil | 1 +
 prebuilts/api/33.0/private/compat/30.0/30.0.ignore.cil | 1 +
 prebuilts/api/33.0/private/compat/31.0/31.0.ignore.cil | 1 +
 prebuilts/api/33.0/private/compat/32.0/32.0.ignore.cil | 1 +
 prebuilts/api/33.0/private/storaged.te                 | 5 +++++
 prebuilts/api/33.0/public/file.te                      | 1 +
 private/compat/28.0/28.0.ignore.cil                    | 1 +
 private/compat/29.0/29.0.ignore.cil                    | 1 +
 private/compat/30.0/30.0.ignore.cil                    | 1 +
 private/compat/31.0/31.0.ignore.cil                    | 1 +
 private/compat/32.0/32.0.ignore.cil                    | 1 +
 private/storaged.te                                    | 5 +++++
 public/file.te                                         | 1 +
 32 files changed, 56 insertions(+)

diff --git a/prebuilts/api/29.0/private/compat/28.0/28.0.ignore.cil b/prebuilts/api/29.0/private/compat/28.0/28.0.ignore.cil
index ed3671f114..e96c241cbb 100644
--- a/prebuilts/api/29.0/private/compat/28.0/28.0.ignore.cil
+++ b/prebuilts/api/29.0/private/compat/28.0/28.0.ignore.cil
@@ -122,6 +122,7 @@
     simpleperf_app_runner_exec
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/prebuilts/api/29.0/private/storaged.te b/prebuilts/api/29.0/private/storaged.te
index 3ed24b2339..a1351d9382 100644
--- a/prebuilts/api/29.0/private/storaged.te
+++ b/prebuilts/api/29.0/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/prebuilts/api/29.0/public/file.te b/prebuilts/api/29.0/public/file.te
index da990e306f..e0aad876d4 100644
--- a/prebuilts/api/29.0/public/file.te
+++ b/prebuilts/api/29.0/public/file.te
@@ -11,6 +11,7 @@ type proc_overcommit_memory, fs_type, proc_type;
 type proc_min_free_order_shift, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
 type usermodehelper, fs_type, proc_type;
+type sysfs_disk_stat, fs_type, sysfs_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
 type proc_qtaguid_stat, fs_type, mlstrustedobject, proc_type;
diff --git a/prebuilts/api/30.0/private/compat/28.0/28.0.ignore.cil b/prebuilts/api/30.0/private/compat/28.0/28.0.ignore.cil
index d24d12d257..fd17ce6430 100644
--- a/prebuilts/api/30.0/private/compat/28.0/28.0.ignore.cil
+++ b/prebuilts/api/30.0/private/compat/28.0/28.0.ignore.cil
@@ -127,6 +127,7 @@
     socket_hook_prop
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/prebuilts/api/30.0/private/compat/29.0/29.0.ignore.cil b/prebuilts/api/30.0/private/compat/29.0/29.0.ignore.cil
index fdea691eac..cfdf55e27f 100644
--- a/prebuilts/api/30.0/private/compat/29.0/29.0.ignore.cil
+++ b/prebuilts/api/30.0/private/compat/29.0/29.0.ignore.cil
@@ -100,6 +100,7 @@
     staged_install_file
     storage_config_prop
     surfaceflinger_display_prop
+    sysfs_disk_stat
     sysfs_dm_verity
     system_adbd_prop
     system_config_service
diff --git a/prebuilts/api/30.0/private/storaged.te b/prebuilts/api/30.0/private/storaged.te
index b7d4ae9ce7..68fa042937 100644
--- a/prebuilts/api/30.0/private/storaged.te
+++ b/prebuilts/api/30.0/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/prebuilts/api/30.0/public/file.te b/prebuilts/api/30.0/public/file.te
index 91257e2376..06c972bdcb 100644
--- a/prebuilts/api/30.0/public/file.te
+++ b/prebuilts/api/30.0/public/file.te
@@ -15,6 +15,7 @@ type proc_min_free_order_shift, fs_type, proc_type;
 type proc_kpageflags, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
 type usermodehelper, fs_type, proc_type;
+type sysfs_disk_stat, fs_type, sysfs_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
 type proc_qtaguid_stat, fs_type, mlstrustedobject, proc_type;
diff --git a/prebuilts/api/31.0/private/compat/28.0/28.0.ignore.cil b/prebuilts/api/31.0/private/compat/28.0/28.0.ignore.cil
index e7ddf48057..fa6204cbd7 100644
--- a/prebuilts/api/31.0/private/compat/28.0/28.0.ignore.cil
+++ b/prebuilts/api/31.0/private/compat/28.0/28.0.ignore.cil
@@ -128,6 +128,7 @@
     socket_hook_prop
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/prebuilts/api/31.0/private/compat/29.0/29.0.ignore.cil b/prebuilts/api/31.0/private/compat/29.0/29.0.ignore.cil
index 10790468f1..9c3a1d5bd1 100644
--- a/prebuilts/api/31.0/private/compat/29.0/29.0.ignore.cil
+++ b/prebuilts/api/31.0/private/compat/29.0/29.0.ignore.cil
@@ -100,6 +100,7 @@
     staged_install_file
     storage_config_prop
     surfaceflinger_display_prop
+    sysfs_disk_stat
     sysfs_dm_verity
     system_adbd_prop
     system_config_service
diff --git a/prebuilts/api/31.0/private/compat/30.0/30.0.ignore.cil b/prebuilts/api/31.0/private/compat/30.0/30.0.ignore.cil
index 0c36aed139..8a579b18e1 100644
--- a/prebuilts/api/31.0/private/compat/30.0/30.0.ignore.cil
+++ b/prebuilts/api/31.0/private/compat/30.0/30.0.ignore.cil
@@ -128,6 +128,7 @@
     sysfs_devfreq_cur
     sysfs_devfreq_dir
     sysfs_devices_cs_etm
+    sysfs_disk_stat
     sysfs_dma_heap
     sysfs_dmabuf_stats
     sysfs_uhid
diff --git a/prebuilts/api/31.0/private/storaged.te b/prebuilts/api/31.0/private/storaged.te
index bb39e5b73f..8b6beed362 100644
--- a/prebuilts/api/31.0/private/storaged.te
+++ b/prebuilts/api/31.0/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/prebuilts/api/31.0/public/file.te b/prebuilts/api/31.0/public/file.te
index dc788ac6a3..578df89b6f 100644
--- a/prebuilts/api/31.0/public/file.te
+++ b/prebuilts/api/31.0/public/file.te
@@ -15,6 +15,7 @@ type proc_min_free_order_shift, fs_type, proc_type;
 type proc_kpageflags, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
 type usermodehelper, fs_type, proc_type;
+type sysfs_disk_stat, fs_type, sysfs_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
 type proc_qtaguid_stat, fs_type, mlstrustedobject, proc_type;
diff --git a/prebuilts/api/32.0/private/compat/28.0/28.0.ignore.cil b/prebuilts/api/32.0/private/compat/28.0/28.0.ignore.cil
index e7ddf48057..fa6204cbd7 100644
--- a/prebuilts/api/32.0/private/compat/28.0/28.0.ignore.cil
+++ b/prebuilts/api/32.0/private/compat/28.0/28.0.ignore.cil
@@ -128,6 +128,7 @@
     socket_hook_prop
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/prebuilts/api/32.0/private/compat/29.0/29.0.ignore.cil b/prebuilts/api/32.0/private/compat/29.0/29.0.ignore.cil
index 10790468f1..9c3a1d5bd1 100644
--- a/prebuilts/api/32.0/private/compat/29.0/29.0.ignore.cil
+++ b/prebuilts/api/32.0/private/compat/29.0/29.0.ignore.cil
@@ -100,6 +100,7 @@
     staged_install_file
     storage_config_prop
     surfaceflinger_display_prop
+    sysfs_disk_stat
     sysfs_dm_verity
     system_adbd_prop
     system_config_service
diff --git a/prebuilts/api/32.0/private/compat/30.0/30.0.ignore.cil b/prebuilts/api/32.0/private/compat/30.0/30.0.ignore.cil
index e4acfe8a4a..a9c670ef80 100644
--- a/prebuilts/api/32.0/private/compat/30.0/30.0.ignore.cil
+++ b/prebuilts/api/32.0/private/compat/30.0/30.0.ignore.cil
@@ -129,6 +129,7 @@
     sysfs_devfreq_cur
     sysfs_devfreq_dir
     sysfs_devices_cs_etm
+    sysfs_disk_stat
     sysfs_dma_heap
     sysfs_dmabuf_stats
     sysfs_uhid
diff --git a/prebuilts/api/32.0/private/compat/31.0/31.0.ignore.cil b/prebuilts/api/32.0/private/compat/31.0/31.0.ignore.cil
index 4e95cc6e48..30ab5ad15a 100644
--- a/prebuilts/api/32.0/private/compat/31.0/31.0.ignore.cil
+++ b/prebuilts/api/32.0/private/compat/31.0/31.0.ignore.cil
@@ -6,4 +6,5 @@
 (typeattributeset new_objects
   ( new_objects
     hypervisor_prop
+    sysfs_disk_stat
   ))
diff --git a/prebuilts/api/32.0/private/storaged.te b/prebuilts/api/32.0/private/storaged.te
index bb39e5b73f..8b6beed362 100644
--- a/prebuilts/api/32.0/private/storaged.te
+++ b/prebuilts/api/32.0/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/prebuilts/api/32.0/public/file.te b/prebuilts/api/32.0/public/file.te
index dc788ac6a3..578df89b6f 100644
--- a/prebuilts/api/32.0/public/file.te
+++ b/prebuilts/api/32.0/public/file.te
@@ -15,6 +15,7 @@ type proc_min_free_order_shift, fs_type, proc_type;
 type proc_kpageflags, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
 type usermodehelper, fs_type, proc_type;
+type sysfs_disk_stat, fs_type, sysfs_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
 type proc_qtaguid_stat, fs_type, mlstrustedobject, proc_type;
diff --git a/prebuilts/api/33.0/private/compat/28.0/28.0.ignore.cil b/prebuilts/api/33.0/private/compat/28.0/28.0.ignore.cil
index e7ddf48057..fa6204cbd7 100644
--- a/prebuilts/api/33.0/private/compat/28.0/28.0.ignore.cil
+++ b/prebuilts/api/33.0/private/compat/28.0/28.0.ignore.cil
@@ -128,6 +128,7 @@
     socket_hook_prop
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/prebuilts/api/33.0/private/compat/29.0/29.0.ignore.cil b/prebuilts/api/33.0/private/compat/29.0/29.0.ignore.cil
index 10790468f1..de5ae310b1 100644
--- a/prebuilts/api/33.0/private/compat/29.0/29.0.ignore.cil
+++ b/prebuilts/api/33.0/private/compat/29.0/29.0.ignore.cil
@@ -101,6 +101,7 @@
     storage_config_prop
     surfaceflinger_display_prop
     sysfs_dm_verity
+    sysfs_disk_stat
     system_adbd_prop
     system_config_service
     system_group_file
diff --git a/prebuilts/api/33.0/private/compat/30.0/30.0.ignore.cil b/prebuilts/api/33.0/private/compat/30.0/30.0.ignore.cil
index ba0a4946a1..482f5a88ec 100644
--- a/prebuilts/api/33.0/private/compat/30.0/30.0.ignore.cil
+++ b/prebuilts/api/33.0/private/compat/30.0/30.0.ignore.cil
@@ -131,6 +131,7 @@
     sysfs_devfreq_cur
     sysfs_devfreq_dir
     sysfs_devices_cs_etm
+    sysfs_disk_stat
     sysfs_dma_heap
     sysfs_dmabuf_stats
     sysfs_uhid
diff --git a/prebuilts/api/33.0/private/compat/31.0/31.0.ignore.cil b/prebuilts/api/33.0/private/compat/31.0/31.0.ignore.cil
index 496832edf3..4e770346a0 100644
--- a/prebuilts/api/33.0/private/compat/31.0/31.0.ignore.cil
+++ b/prebuilts/api/33.0/private/compat/31.0/31.0.ignore.cil
@@ -43,6 +43,7 @@
     untrusted_app_30
     proc_vendor_sched
     sdk_sandbox_service
+    sysfs_disk_stat
     sysfs_fs_fuse_bpf
     sysfs_vendor_sched
     tv_iapp_service
diff --git a/prebuilts/api/33.0/private/compat/32.0/32.0.ignore.cil b/prebuilts/api/33.0/private/compat/32.0/32.0.ignore.cil
index 7c3058ebc4..389e508ad9 100644
--- a/prebuilts/api/33.0/private/compat/32.0/32.0.ignore.cil
+++ b/prebuilts/api/33.0/private/compat/32.0/32.0.ignore.cil
@@ -70,6 +70,7 @@
     selection_toolbar_service
     smart_idle_maint_enabled_prop
     snapuserd_proxy_socket
+    sysfs_disk_stat
     sysfs_fs_fuse_bpf
     sysfs_gpu
     sysfs_lru_gen_enabled
diff --git a/prebuilts/api/33.0/private/storaged.te b/prebuilts/api/33.0/private/storaged.te
index bb39e5b73f..8b6beed362 100644
--- a/prebuilts/api/33.0/private/storaged.te
+++ b/prebuilts/api/33.0/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/prebuilts/api/33.0/public/file.te b/prebuilts/api/33.0/public/file.te
index 2bfa282fac..cc70823d6b 100644
--- a/prebuilts/api/33.0/public/file.te
+++ b/prebuilts/api/33.0/public/file.te
@@ -16,6 +16,7 @@ type proc_min_free_order_shift, fs_type, proc_type;
 type proc_kpageflags, fs_type, proc_type;
 type proc_watermark_boost_factor, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
+type sysfs_disk_stat, fs_type, sysfs_type;
 type usermodehelper, fs_type, proc_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
diff --git a/private/compat/28.0/28.0.ignore.cil b/private/compat/28.0/28.0.ignore.cil
index e7ddf48057..fa6204cbd7 100644
--- a/private/compat/28.0/28.0.ignore.cil
+++ b/private/compat/28.0/28.0.ignore.cil
@@ -128,6 +128,7 @@
     socket_hook_prop
     su_tmpfs
     super_block_device
+    sysfs_disk_stat
     sysfs_fs_f2fs
     system_bootstrap_lib_file
     system_event_log_tags_file
diff --git a/private/compat/29.0/29.0.ignore.cil b/private/compat/29.0/29.0.ignore.cil
index 10790468f1..9c3a1d5bd1 100644
--- a/private/compat/29.0/29.0.ignore.cil
+++ b/private/compat/29.0/29.0.ignore.cil
@@ -100,6 +100,7 @@
     staged_install_file
     storage_config_prop
     surfaceflinger_display_prop
+    sysfs_disk_stat
     sysfs_dm_verity
     system_adbd_prop
     system_config_service
diff --git a/private/compat/30.0/30.0.ignore.cil b/private/compat/30.0/30.0.ignore.cil
index ba0a4946a1..482f5a88ec 100644
--- a/private/compat/30.0/30.0.ignore.cil
+++ b/private/compat/30.0/30.0.ignore.cil
@@ -131,6 +131,7 @@
     sysfs_devfreq_cur
     sysfs_devfreq_dir
     sysfs_devices_cs_etm
+    sysfs_disk_stat
     sysfs_dma_heap
     sysfs_dmabuf_stats
     sysfs_uhid
diff --git a/private/compat/31.0/31.0.ignore.cil b/private/compat/31.0/31.0.ignore.cil
index 496832edf3..4e770346a0 100644
--- a/private/compat/31.0/31.0.ignore.cil
+++ b/private/compat/31.0/31.0.ignore.cil
@@ -43,6 +43,7 @@
     untrusted_app_30
     proc_vendor_sched
     sdk_sandbox_service
+    sysfs_disk_stat
     sysfs_fs_fuse_bpf
     sysfs_vendor_sched
     tv_iapp_service
diff --git a/private/compat/32.0/32.0.ignore.cil b/private/compat/32.0/32.0.ignore.cil
index 7c3058ebc4..389e508ad9 100644
--- a/private/compat/32.0/32.0.ignore.cil
+++ b/private/compat/32.0/32.0.ignore.cil
@@ -70,6 +70,7 @@
     selection_toolbar_service
     smart_idle_maint_enabled_prop
     snapuserd_proxy_socket
+    sysfs_disk_stat
     sysfs_fs_fuse_bpf
     sysfs_gpu
     sysfs_lru_gen_enabled
diff --git a/private/storaged.te b/private/storaged.te
index bb39e5b73f..8b6beed362 100644
--- a/private/storaged.te
+++ b/private/storaged.te
@@ -7,6 +7,11 @@ init_daemon_domain(storaged)
 # Read access to pseudo filesystems
 r_dir_file(storaged, domain)
 
+# Allow read access to /sys/block/mmcblk0/stat or /sys/block/sda/stat.
+# Implementations typically have symlinks to vendor specific files.
+# Vendors should mark sysfs_disk_stat on all files read by storaged.
+r_dir_file(storaged, sysfs_disk_stat)
+
 # Read /proc/uid_io/stats
 allow storaged proc_uid_io_stats:file r_file_perms;
 
diff --git a/public/file.te b/public/file.te
index 2bfa282fac..b7617d5c0b 100644
--- a/public/file.te
+++ b/public/file.te
@@ -17,6 +17,7 @@ type proc_kpageflags, fs_type, proc_type;
 type proc_watermark_boost_factor, fs_type, proc_type;
 # proc, sysfs, or other nodes that permit configuration of kernel usermodehelpers.
 type usermodehelper, fs_type, proc_type;
+type sysfs_disk_stat, fs_type, sysfs_type;
 type sysfs_usermodehelper, fs_type, sysfs_type;
 type proc_qtaguid_ctrl, fs_type, mlstrustedobject, proc_type;
 type proc_qtaguid_stat, fs_type, mlstrustedobject, proc_type;
